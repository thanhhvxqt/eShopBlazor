$(function(){$("#hotenerrortxt").hide();$("#emailerrortxt").hide();$("#usernameerrortxt").hide();$("#passnerrortxt").hide();$("#repasserrortxt").hide();var error_hoten=false;var error_email=false;var error_username=false;var error_pass=false;var error_repass=false;$("#hotentxt").focusout(function(){check_hoten();});$("#emailtxt").focusout(function(){check_email();});$("#usernametxt").focusout(function(){check_username();});$("#passtxt").focusout(function(){check_pass();});$("#repasstxt").focusout(function(){check_repass();});function check_hoten(){var hoten=$("#hotentxt").val()
var hoten_length=hoten.length;if(hoten_length<3||hoten_length>50){$("#hotenerrortxt").html("Tối thiểu 3 ký tự và tối đa 50 ký tự");$("#hotenerrortxt").show();error_hoten=true;}else{$.ajax({type:"POST",url:"/Account/CheckRegister",data:{text:hoten},success:function(data){if(data=="Khóa"){$("#hotenerrortxt").html("Tên có ký tự bị cấm");$("#hotenerrortxt").show();error_hoten=true;}else{$("#hotenerrortxt").hide();error_hoten=false;}},error:function(data){console.log(data)}});}}
function check_username(){var username=$("#usernametxt").val();var pattern=new RegExp(/^[a-z0-9]+$/);var username_length=username.length;if(pattern.test(username)){if(username_length<3||username_length>20){$("#usernameerrortxt").html("Tối thiểu 3 ký tự và tối đa 20 ký tự");$("#usernameerrortxt").show();error_username=true;}else{$.ajax({type:"POST",url:"/Account/CheckRegister",data:{text:username},success:function(data){console.log(data)
if(data=="Khóa"){$("#usernameerrortxt").html("Username có ký tự cấm");$("#usernameerrortxt").show();error_username=true;}else if(data=="Username"){$("#usernameerrortxt").html("Username đã có người sử dụng");$("#usernameerrortxt").show();error_username=true;}else{$("#usernameerrortxt").hide();error_username=false;}},error:function(data){console.log(data)}});}}else{$("#usernameerrortxt").html("Username KHÔNG viết dấu, khoảng cách, in hoa và ký tự đặc biệt");$("#usernameerrortxt").show();error_username=true;}}
function check_email(){var email=$("#emailtxt").val();var pattern=new RegExp(/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/i);if(pattern.test(email)){$.ajax({type:"POST",url:"/Account/CheckRegister",data:{text:email},success:function(data){if(data=="Email"){$("#emailerrortxt").html("Email đã có người sử dụng");$("#emailerrortxt").show();error_email=true;}else{$("#emailerrortxt").hide();error_email=false;}},error:function(data){console.log(data)}});}else{$("#emailerrortxt").html("Email không đúng định dạng");$("#emailerrortxt").show();error_email=true;}}
function check_pass(){var pattern=new RegExp(/^[A-Za-z0-9_!@#$%^&*]+$/);var pass=$("#passtxt").val();var pass_length=pass.length;if(pattern.test(pass)){if(pass_length<6||pass_length>30){$("#passerrortxt").html("Tối thiểu 6 ký tự và tối đa 30 ký tự");$("#passerrortxt").show();error_pass=true;}else{$("#passerrortxt").hide();error_pass=false;}}else{$("#passerrortxt").html("Mật khẩu không được có khoảng cách");$("#passerrortxt").show();error_pass=true;}}
function check_repass(){var pass=$("#passtxt").val();var repass=$("#repasstxt").val()
if(repass!=pass){$("#repasserrortxt").html("Mật khẩu không khớp");$("#repasserrortxt").show();error_repass=true;}else{$("#repasserrortxt").hide();error_repass=false;}}
$("#formdangky").submit(function(e){e.preventDefault();check_email()
check_hoten()
check_pass()
check_repass()
check_username()
if(error_email==false&&error_hoten==false&&error_pass==false&&error_repass==false&&error_username==false){ShowLoading()
$.ajax({type:'post',url:'/signup',data:$('#formdangky').serialize(),success:function(data){HideLoading()
eval(data)}});grecaptcha.reset();}else{$('#formdangky').get(0).setAttribute('action','');return false;}})});